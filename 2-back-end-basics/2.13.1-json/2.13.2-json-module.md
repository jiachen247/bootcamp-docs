# 2.13.2: JSON Module

We'll standardize the way we save and keep data for our javascript programs with JSON.

Refer to lines 15, 18 and 21 to see where we process the JSON in the file.

#### jsonFileStorage.js

```javascript
// get the node libraries
import { readFile, writeFile } from 'fs';

export function add(filename, key, value) {
  // set the file read callback
  const whenFileIsRead = (error, JsonContent) => {
    // check for reading errors
    if (error) {
      console.log('reading error', error);
    }

    // start dealing with the JSON
    
    // parse the string into a *real* JavaScript object
    const content = JSON.parse(JsonContent);

    // this function only sets one key and value
    content[key] = value;

    // turn it back into a string to store in the file
    const outputContent = JSON.stringify(content);

    writeFile(filename, outputContent, (err) => {
      if (err) {
        console.log('error writing', newContent, err);
      } else {
        // file written successfully
        console.log('success!');
      }
    });
  };

  // read the file
  readFile(filename, 'utf-8', whenFileIsRead);
}
```

The file, `data.json` begins empty. \(as an empty object, not an empty file\).

```javascript
{}
```

Use it like this:

```javascript
import { add } from 'jsonFileStorage';

// ...

add( 'data.json', 'name', 'kai' );
```

`data.json` will look like this:

```javascript
{"name":"kai"}
```

## Read

#### jsonFileStorage.js

```javascript
// ...

export function read(filename) {
  // set the file read callback
  const whenFileIsRead = (error, jsonContent) => {
    // check for reading errors
    if (error) {
      console.log('reading error', error);
    }
    
    console.log( jsonContent );
  };

  // read the file
  readFile(filename, 'utf-8', whenFileIsRead);
}
```

## Write

#### jsonFileStorage.js

```javascript
// ...

export function write(filename, content) {

  const stringContent = JSON.stringify(content);

  // set the file read callback
  const whenFileIsWritten = (error, jsonContent) => {
    // check for reading errors
    if (error) {
      console.log('writing error', error);
    }
    
    console.log( jsonContent );
  };

  // read the file
  writeFile(filename, stringContent, whenFileIsWritten);
}
```

