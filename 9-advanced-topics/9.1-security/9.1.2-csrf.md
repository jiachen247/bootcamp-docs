# 9.1.2: CSRF

A request can be sent as the viewing user and /or a request can be forged by an attacker.

CSRF stands for Cross-Site Request Forgery. This is when a request that is supposed to originate from something like a form submit is actually generated from somewhere else on the internet.

For example, the sample app is made so that we do not check for CSRF.

The following link will reset the password of a logged in user who clicks on it: [https://blooming-cliffs-44482.herokuapp.com/?email=someemail@attacker.com&password=1234](https://blooming-cliffs-44482.herokuapp.com/?email=someemail@attacker.com&password=1234)  
  
The relevant code is here: [https://github.com/rocketacademy/express-security-bootcamp/blob/main/index.js\#L199](https://github.com/rocketacademy/express-security-bootcamp/blob/main/index.js#L199)  
  
The route uses GET instead of POST or PUT. Even though it verifies the user, if the user had clicked on the above link, they would have been logged in, and their password would have been changed. 

```javascript
app.get('/user/edit', checkAuth, (request, response) => {

  const values = [
    request.query.email,
    getHash(request.query.password),
    request.cookies.userId
  ];

  pool.query('UPDATE users SET email=$1 password=$2 WHERE id=$3', values)
    .then((result) => {
      response.send('done');
    }).catch((error) => {
      console.log('Error executing query', error.stack);
      response.status(503).send('sorry');
    });
});
```







